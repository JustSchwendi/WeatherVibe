<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weather Dashboard</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>

  <style>
    body { background: radial-gradient(circle at top, #0f172a, #020617); }
    .neon { text-shadow: 0 0 10px #06b6d4, 0 0 20px #3b82f6, 0 0 40px #06b6d4; }
    .glass { backdrop-filter: blur(10px); background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); }
    .fade-in { animation: fadeIn 1.2s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px);} to { opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body class="text-gray-100 font-sans min-h-screen flex flex-col">
  <!-- Hero -->
  <header class="p-6 text-center">
    <h1 class="text-5xl md:text-6xl font-bold neon animate-pulse">🌌 Weather Dashboard</h1>
    <p class="mt-3 text-gray-400">Powered by Open-Meteo • Dark Neon Edition ⚡</p>
    <div class="mt-6 flex justify-center gap-3">
      <input id="cityInput" type="text" placeholder="Search city..."
             class="px-4 py-2 rounded-lg glass border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-400 w-60 text-gray-100"/>
      <button id="searchBtn" class="px-4 py-2 bg-cyan-500 hover:bg-cyan-600 rounded-lg font-semibold shadow-lg">Search</button>
      <button id="geoBtn" class="px-4 py-2 bg-indigo-500 hover:bg-indigo-600 rounded-lg font-semibold shadow-lg">📍 My Location</button>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-1 max-w-6xl mx-auto px-6 grid gap-6 md:grid-cols-2 fade-in">
    <!-- Current Weather -->
    <section class="glass p-6 rounded-2xl shadow-lg flex flex-col justify-between">
      <div>
        <h2 id="place" class="text-3xl font-bold">—</h2>
        <p id="coords" class="text-sm text-gray-400">—</p>
      </div>
      <div class="flex items-center justify-between mt-6">
        <div class="text-8xl" id="emoji">—</div>
        <div class="text-right">
          <div class="text-6xl font-extrabold"><span id="temp">—</span>°C</div>
          <div id="desc" class="text-gray-300 mt-2">—</div>
        </div>
      </div>
      <div class="grid grid-cols-3 gap-3 mt-6 text-center">
        <div><div class="font-semibold">💨 Wind</div><div id="wind">— km/h</div></div>
        <div><div class="font-semibold">💧 Humidity</div><div id="humidity">—%</div></div>
        <div><div class="font-semibold">☀️ UV</div><div id="uv">—</div></div>
      </div>
    </section>

    <!-- Hourly Chart -->
    <section class="glass p-6 rounded-2xl shadow-lg">
      <h3 class="text-xl font-bold mb-3">Next 24 hours</h3>
      <canvas id="hourlyChart" height="120"></canvas>
    </section>

    <!-- 7 Day Forecast -->
    <section class="glass p-6 rounded-2xl shadow-lg md:col-span-2">
      <h3 class="text-xl font-bold mb-4">7-Day Forecast</h3>
      <div id="daily" class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-7 gap-4"></div>
    </section>
  </main>

  <footer class="p-6 text-center text-gray-500 text-sm">
    Data: <a class="underline hover:text-cyan-400" href="https://open-meteo.com/" target="_blank">Open-Meteo</a>
  </footer>

  <script>
    const WMO = { 0:["Clear","☀️"],1:["Mainly clear","🌤️"],2:["Partly cloudy","⛅"],3:["Overcast","☁️"],45:["Fog","🌫️"],48:["Rime fog","🌫️"],51:["Light drizzle","🌦️"],53:["Drizzle","🌦️"],55:["Dense drizzle","🌧️"],61:["Light rain","🌧️"],63:["Rain","🌧️"],65:["Heavy rain","🌧️"],71:["Light snow","🌨️"],73:["Snow","🌨️"],75:["Heavy snow","❄️"],80:["Rain showers","🌦️"],95:["Thunderstorm","⛈️"],99:["Storm + hail","🌩️"] };
    const $=id=>document.getElementById(id);
    let chart;

    async function geocodeCity(q){
      const r=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(q)}&count=1&language=en&format=json`);
      const d=await r.json(); if(!d.results) throw Error("City not found"); return d.results[0];
    }

    async function fetchWeather(lat,lon){
      const p=new URLSearchParams({latitude:lat,longitude:lon,timezone:'auto',current:'temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m,uv_index',hourly:'temperature_2m,weather_code',daily:'weather_code,temperature_2m_max,temperature_2m_min,uv_index_max'});
      return (await fetch(`https://api.open-meteo.com/v1/forecast?${p}`)).json();
    }

    function setCurrent(place,lat,lon,data){
      const c=data.current; const [desc,emo]=WMO[c.weather_code]||["Unknown","🌡️"];
      $("place").textContent=place; $("coords").textContent=`${lat.toFixed(2)}, ${lon.toFixed(2)} • ${data.timezone}`;
      $("temp").textContent=Math.round(c.temperature_2m); $("desc").textContent=`${desc} • Feels ${Math.round(c.apparent_temperature)}°C`; $("emoji").textContent=emo;
      $("wind").textContent=`${Math.round(c.wind_speed_10m)} km/h`; $("humidity").textContent=`${c.relative_humidity_2m}%`; $("uv").textContent=c.uv_index??"—";
    }

    function setDaily(d){
      $("daily").innerHTML=""; d.time.forEach((t,i)=>{const day=new Date(t).toLocaleDateString(undefined,{weekday:"short"}); const [desc,emo]=WMO[d.weather_code[i]]||["—","❓"];
        $("daily").innerHTML+=`<div class="glass rounded-xl p-3 text-center"><div class="font-semibold">${day}</div><div class="text-3xl">${emo}</div><div class="text-sm">${desc}</div><div class="mt-1 font-medium">${Math.round(d.temperature_2m_max[i])}°/${Math.round(d.temperature_2m_min[i])}°</div><div class="text-xs text-gray-400">UV ${d.uv_index_max[i]??"—"}</div></div>`;});
    }

    function setHourlyChart(h){
      const now=h.time.findIndex(t=>new Date(t)>new Date()); const end=now+24;
      const labels=h.time.slice(now,end).map(t=>new Date(t).getHours()+":00");
      const temps=h.temperature_2m.slice(now,end);
      if(chart) chart.destroy(); chart=new Chart($("hourlyChart").getContext("2d"),{type:"line",data:{labels,datasets:[{label:"Temp °C",data:temps,borderColor:"#06b6d4",backgroundColor:"#06b6d4"}]},options:{plugins:{legend:{labels:{color:"white"}}},scales:{x:{ticks:{color:"white"}},y:{ticks:{color:"white"}}}}});
    }

    async function loadByCoords(lat,lon,label="Location"){
      const d=await fetchWeather(lat,lon); setCurrent(label,lat,lon,d); setDaily(d.daily); setHourlyChart(d.hourly);
    }

    async function searchCity(){const q=$("cityInput").value.trim(); if(!q) return; const r=await geocodeCity(q); await loadByCoords(r.latitude,r.longitude,`${r.name}, ${r.country}`);}

    $("searchBtn").onclick=searchCity; $("cityInput").addEventListener("keydown",e=>{if(e.key==="Enter") searchCity();});
    $("geoBtn").onclick=()=>navigator.geolocation.getCurrentPosition(p=>loadByCoords(p.coords.latitude,p.coords.longitude,"My Location"));

    loadByCoords(48.2082,16.3738,"Vienna, AT");
  </script>
</body>
</html>
